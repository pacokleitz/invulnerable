package models

import "time"

type Vulnerability struct {
	ID              int        `db:"id" json:"id"`
	CVEID           string     `db:"cve_id" json:"cve_id"`
	PackageName     string     `db:"package_name" json:"package_name"`
	PackageVersion  string     `db:"package_version" json:"package_version"`
	PackageType     *string    `db:"package_type" json:"package_type,omitempty"`
	Severity        string     `db:"severity" json:"severity"`
	FixVersion      *string    `db:"fix_version" json:"fix_version,omitempty"`
	URL             *string    `db:"url" json:"url,omitempty"`
	Description     *string    `db:"description" json:"description,omitempty"`
	Status          string     `db:"status" json:"status"` // active, fixed, ignored, accepted
	FirstDetectedAt time.Time  `db:"first_detected_at" json:"first_detected_at"`
	LastSeenAt      time.Time  `db:"last_seen_at" json:"last_seen_at"`
	RemediationDate *time.Time `db:"remediation_date" json:"remediation_date,omitempty"`
	Notes           *string    `db:"notes" json:"notes,omitempty"`
	CreatedAt       time.Time  `db:"created_at" json:"created_at"`
	UpdatedAt       time.Time  `db:"updated_at" json:"updated_at"`
}

type VulnerabilityUpdate struct {
	Status *string `json:"status,omitempty"`
	Notes  *string `json:"notes,omitempty"`
}

// ScanVulnerability represents the junction table
type ScanVulnerability struct {
	ID              int       `db:"id" json:"id"`
	ScanID          int       `db:"scan_id" json:"scan_id"`
	VulnerabilityID int       `db:"vulnerability_id" json:"vulnerability_id"`
	CreatedAt       time.Time `db:"created_at" json:"created_at"`
}
