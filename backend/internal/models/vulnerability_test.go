package models

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestValidStatuses(t *testing.T) {
	expected := []string{"active", "in_progress", "fixed", "ignored", "accepted"}
	assert.Equal(t, expected, ValidStatuses)
}

func TestStatusConstants(t *testing.T) {
	assert.Equal(t, "active", StatusActive)
	assert.Equal(t, "in_progress", StatusInProgress)
	assert.Equal(t, "fixed", StatusFixed)
	assert.Equal(t, "ignored", StatusIgnored)
	assert.Equal(t, "accepted", StatusAccepted)
}

func TestVulnerabilityUpdateWithContext_Fields(t *testing.T) {
	status := "fixed"
	notes := "test notes"
	imageID := 123
	imageName := "test/image:latest"

	update := VulnerabilityUpdateWithContext{
		Status:    &status,
		Notes:     &notes,
		UpdatedBy: "user@example.com",
		ImageID:   &imageID,
		ImageName: &imageName,
	}

	assert.Equal(t, &status, update.Status)
	assert.Equal(t, &notes, update.Notes)
	assert.Equal(t, "user@example.com", update.UpdatedBy)
	assert.Equal(t, &imageID, update.ImageID)
	assert.Equal(t, &imageName, update.ImageName)
}

func TestBulkUpdateRequest_Fields(t *testing.T) {
	status := "fixed"
	notes := "bulk update notes"
	req := BulkUpdateRequest{
		VulnerabilityIDs: []int{1, 2, 3},
		Status:           &status,
		Notes:            &notes,
	}

	assert.Len(t, req.VulnerabilityIDs, 3)
	assert.Equal(t, &status, req.Status)
	assert.Equal(t, &notes, req.Notes)
}
